echo "üîç Ex√©cution des v√©rifications pre-commit..."

# Utilise Turborepo pour optimiser les v√©rifications
CHANGED_FILES=$(git diff --cached --name-only)

# D√©tecte les changements pour le website
if echo "$CHANGED_FILES" | grep -q "^apps/utopia-website/.*\.(js|ts|vue)$"; then
    echo "üîç V√©rifications website..."
    npx turbo lint type-check --filter=utopia-website
fi

# D√©tecte les changements pour le design system
if echo "$CHANGED_FILES" | grep -q "^packages/utopia/.*\.(js|ts|vue)$"; then
    echo "üé® V√©rifications design system..."
    npx turbo lint type-check build:tokens --filter=@club-employes/utopia
fi

# Validation globale si changements tokens
if echo "$CHANGED_FILES" | grep -qE "^(apps/utopia-website/.*|packages/utopia/src/tokens/.*)$"; then
    echo "üé® Validation des tokens du design system..."
    npx turbo validate:design-system --filter=utopia-website
fi

echo "‚úÖ Toutes les v√©rifications sont pass√©es !"
